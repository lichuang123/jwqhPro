<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.thinkgem.jeesite.modules.video_m_n.dao.VideoTableMapper" >
  <resultMap id="BaseResultMap" type="com.thinkgem.jeesite.modules.video_m_n.entity.VideoTable" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 28 22:59:27 CST 2016.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="video_name" property="videoName" jdbcType="VARCHAR" />
    <result column="video_type" property="videoType" jdbcType="CHAR" />
    <result column="video_belongto" property="videoBelongto" jdbcType="VARCHAR" />
    <result column="video_context" property="videoContext" jdbcType="VARCHAR" />
    <result column="video_createTime" property="videoCreatetime" jdbcType="TIMESTAMP" />
    <result column="video_createUser" property="videoCreateuser" jdbcType="VARCHAR" />
    <result column="video_photo_url" property="videoPhotoUrl" jdbcType="VARCHAR" />
    <result column="ATTRA" property="attra" jdbcType="VARCHAR" />
    <result column="ATTRB" property="attrb" jdbcType="VARCHAR" />
    <result column="ATTRC" property="attrc" jdbcType="VARCHAR" />
    <result column="ATTRD" property="attrd" jdbcType="VARCHAR" />
    <result column="ATTRE" property="attre" jdbcType="VARCHAR" />
    <result column="ATTRF" property="attrf" jdbcType="VARCHAR" />
    <result column="ATTRG" property="attrg" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 28 22:59:27 CST 2016.
    -->
    id, video_name, video_type, video_belongto, video_context, video_createTime, video_createUser, 
    ATTRA, ATTRB, ATTRC, ATTRD, ATTRE, ATTRF, ATTRG
  </sql>
  
  <!-- 模糊查询 -->
  <select id="searchVideo" parameterType="java.lang.String" resultType="java.util.Map" useCache="false">
  	SELECT
		id,
		video_name
	FROM
		video_table
	WHERE
		video_name LIKE 
	concat('%',concat(#{searchName},'%'))
  </select>
  
  <!-- 查询电影、电视剧、专题 -->
  <select id="selectThreeTypeVideoHost" parameterType="java.util.Map" resultType="java.util.Map" useCache="false">
  	SELECT
		id,
		video_name,
		video_type,
		video_photo_url
	FROM
		video_table
	WHERE
		video_belongto = #{belongto}
	AND
		video_type = #{videoType}
	limit 0,4
  </select>
  
  <!-- 查询三种次数 -->
  <select id="selectThreeCount" parameterType="java.lang.Integer" resultType="java.util.Map" useCache="false">
  	SELECT
		video_play_count,
		video_like_count,
		video_hite_count
	FROM
		video_table_count
	WHERE
		id = #{vtcId}
  </select>
  
  <!-- 修改视频不喜欢次数 -->
  <update id="updateVideoHiteCount" parameterType="java.util.Map" flushCache="false">
  	UPDATE video_table_count
	SET video_hite_count = #{count}
	WHERE
		id = #{vtcId}
  </update>
  <select id="selectHiteCountById" parameterType="java.lang.Integer" resultType="java.lang.Integer" useCache="false">
  	SELECT
		video_hite_count
	FROM
		video_table_count
	WHERE
		id = #{vtcId}
  </select>
  
  <!-- 修改视频点赞次数 -->
  <update id="updateVideoLikeCount" parameterType="java.util.Map" flushCache="false">
  	UPDATE video_table_count
	SET video_like_count = #{count}
	WHERE
		id = #{vtcId}
  </update>
  <select id="selectLikeCountById" parameterType="java.lang.Integer" resultType="java.lang.Integer" useCache="false">
  	SELECT
		CASE WHEN video_like_count IS NULL THEN 0
		ELSE video_like_count END video_like_count
	FROM
		video_table_count
	WHERE
		id = #{vtcId};
  </select>
  
  <!-- 修改视频观看次数 -->
  <update id="updateVideoPlayCount" parameterType="java.util.Map" flushCache="false">
  	UPDATE video_table_count
	SET video_play_count = #{count}
	WHERE
		id = #{vtcId}
  </update>
  <select id="selectPlayCountById" parameterType="java.lang.Integer" resultType="java.lang.Integer" useCache="false">
  	SELECT
		CASE WHEN video_play_count IS NULL THEN 0
		ELSE video_play_count END video_play_count
	FROM
		video_table_count
	WHERE
		id = #{vtcId}
  </select>
  
  <!-- 查询下载地址 -->
  <select id="selectDownAddressById" parameterType="java.lang.Integer" resultType="java.util.Map" useCache="false">
  	SELECT
		vt.video_name video_name,
		vtc.video_down_address video_down_address
	FROM
		video_table vt,video_table_count vtc
	WHERE
		vt.id = vtc.video_id
	AND
		vtc.id = #{vtcId}
  </select>
  
  <!-- 展示详情 -->
  <select id="showPermissionVideo" parameterType="java.lang.Integer" resultType="java.util.Map" useCache="false">
  	SELECT
		vt.id,
		vtc.id vtcId,
		vt.video_name,
		vt.video_type,
		vt.video_photo_url,
		vt.video_context,
		vtc.video_address,
		CASE WHEN vtc.video_hite_count is NULL THEN 0
		else vtc.video_hite_count END video_hite_count,
		CASE WHEN vtc.video_like_count is NULL THEN 0
		else vtc.video_like_count END video_like_count,
		vtc.video_order,
		case WHEN vtc.video_play_count is NULL THEN 0 
		else vtc.video_play_count END video_play_count
	FROM
		video_table vt,video_table_count vtc
	WHERE
		vt.id = vtc.video_id
	AND
		vt.id = #{id}
  </select>
  
  <!-- 首页热点视频 -->
  <select id="selectHostVideo" resultType="java.util.Map" parameterType="java.util.Map" useCache="false">
  	SELECT
		id,
		video_name,
		video_type,
		video_photo_url
	FROM
		video_table
	WHERE
		1=1
	<if test="belongto != null">
		and video_belongto = #{belongto}
	</if>
	<if test="videoType != null">
		and video_type = #{videoType}
	</if>
	limit #{start},#{pageSize}
  </select>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 28 22:59:27 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from video_table
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 28 22:59:27 CST 2016.
    -->
    delete from video_table
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.thinkgem.jeesite.modules.video_m_n.entity.VideoTable" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 28 22:59:27 CST 2016.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="id" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into video_table (video_name, video_type, video_belongto, 
      video_context, video_createTime, video_createUser, 
      ATTRA, ATTRB, ATTRC, 
      ATTRD, ATTRE, ATTRF, 
      ATTRG)
    values (#{videoName,jdbcType=VARCHAR}, #{videoType,jdbcType=CHAR}, #{videoBelongto,jdbcType=VARCHAR}, 
      #{videoContext,jdbcType=VARCHAR}, #{videoCreatetime,jdbcType=TIMESTAMP}, #{videoCreateuser,jdbcType=VARCHAR}, 
      #{attra,jdbcType=VARCHAR}, #{attrb,jdbcType=VARCHAR}, #{attrc,jdbcType=VARCHAR}, 
      #{attrd,jdbcType=VARCHAR}, #{attre,jdbcType=VARCHAR}, #{attrf,jdbcType=VARCHAR}, 
      #{attrg,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.thinkgem.jeesite.modules.video_m_n.entity.VideoTable" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 28 22:59:27 CST 2016.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="id" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into video_table
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="videoName != null" >
        video_name,
      </if>
      <if test="videoType != null" >
        video_type,
      </if>
      <if test="videoBelongto != null" >
        video_belongto,
      </if>
      <if test="videoContext != null" >
        video_context,
      </if>
      <if test="videoCreatetime != null" >
        video_createTime,
      </if>
      <if test="videoCreateuser != null" >
        video_createUser,
      </if>
      <if test="attra != null" >
        ATTRA,
      </if>
      <if test="attrb != null" >
        ATTRB,
      </if>
      <if test="attrc != null" >
        ATTRC,
      </if>
      <if test="attrd != null" >
        ATTRD,
      </if>
      <if test="attre != null" >
        ATTRE,
      </if>
      <if test="attrf != null" >
        ATTRF,
      </if>
      <if test="attrg != null" >
        ATTRG,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="videoName != null" >
        #{videoName,jdbcType=VARCHAR},
      </if>
      <if test="videoType != null" >
        #{videoType,jdbcType=CHAR},
      </if>
      <if test="videoBelongto != null" >
        #{videoBelongto,jdbcType=VARCHAR},
      </if>
      <if test="videoContext != null" >
        #{videoContext,jdbcType=VARCHAR},
      </if>
      <if test="videoCreatetime != null" >
        #{videoCreatetime,jdbcType=TIMESTAMP},
      </if>
      <if test="videoCreateuser != null" >
        #{videoCreateuser,jdbcType=VARCHAR},
      </if>
      <if test="attra != null" >
        #{attra,jdbcType=VARCHAR},
      </if>
      <if test="attrb != null" >
        #{attrb,jdbcType=VARCHAR},
      </if>
      <if test="attrc != null" >
        #{attrc,jdbcType=VARCHAR},
      </if>
      <if test="attrd != null" >
        #{attrd,jdbcType=VARCHAR},
      </if>
      <if test="attre != null" >
        #{attre,jdbcType=VARCHAR},
      </if>
      <if test="attrf != null" >
        #{attrf,jdbcType=VARCHAR},
      </if>
      <if test="attrg != null" >
        #{attrg,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.thinkgem.jeesite.modules.video_m_n.entity.VideoTable" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 28 22:59:27 CST 2016.
    -->
    update video_table
    <set >
      <if test="videoName != null" >
        video_name = #{videoName,jdbcType=VARCHAR},
      </if>
      <if test="videoType != null" >
        video_type = #{videoType,jdbcType=CHAR},
      </if>
      <if test="videoBelongto != null" >
        video_belongto = #{videoBelongto,jdbcType=VARCHAR},
      </if>
      <if test="videoContext != null" >
        video_context = #{videoContext,jdbcType=VARCHAR},
      </if>
      <if test="videoCreatetime != null" >
        video_createTime = #{videoCreatetime,jdbcType=TIMESTAMP},
      </if>
      <if test="videoCreateuser != null" >
        video_createUser = #{videoCreateuser,jdbcType=VARCHAR},
      </if>
      <if test="attra != null" >
        ATTRA = #{attra,jdbcType=VARCHAR},
      </if>
      <if test="attrb != null" >
        ATTRB = #{attrb,jdbcType=VARCHAR},
      </if>
      <if test="attrc != null" >
        ATTRC = #{attrc,jdbcType=VARCHAR},
      </if>
      <if test="attrd != null" >
        ATTRD = #{attrd,jdbcType=VARCHAR},
      </if>
      <if test="attre != null" >
        ATTRE = #{attre,jdbcType=VARCHAR},
      </if>
      <if test="attrf != null" >
        ATTRF = #{attrf,jdbcType=VARCHAR},
      </if>
      <if test="attrg != null" >
        ATTRG = #{attrg,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.thinkgem.jeesite.modules.video_m_n.entity.VideoTable" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 28 22:59:27 CST 2016.
    -->
    update video_table
    set video_name = #{videoName,jdbcType=VARCHAR},
      video_type = #{videoType,jdbcType=CHAR},
      video_belongto = #{videoBelongto,jdbcType=VARCHAR},
      video_context = #{videoContext,jdbcType=VARCHAR},
      video_createTime = #{videoCreatetime,jdbcType=TIMESTAMP},
      video_createUser = #{videoCreateuser,jdbcType=VARCHAR},
      ATTRA = #{attra,jdbcType=VARCHAR},
      ATTRB = #{attrb,jdbcType=VARCHAR},
      ATTRC = #{attrc,jdbcType=VARCHAR},
      ATTRD = #{attrd,jdbcType=VARCHAR},
      ATTRE = #{attre,jdbcType=VARCHAR},
      ATTRF = #{attrf,jdbcType=VARCHAR},
      ATTRG = #{attrg,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
</mapper>